From 498600a803104ecfabcc4880b4e4ef2de71e0041 Mon Sep 17 00:00:00 2001
From: "h.udo" <hudokkow@gmail.com>
Date: Wed, 6 Jan 2016 15:08:56 +0000
Subject: [PATCH 1/2] [src] Update to p8-platform

---
 src/Socket.cpp            |  4 ++--
 src/client.h              |  2 +-
 src/liveshift.cpp         |  2 +-
 src/liveshift.h           |  2 +-
 src/md5.h                 |  2 +-
 src/os-dependent.h        |  2 +-
 src/pvrclient-nextpvr.cpp | 12 ++++++------
 src/pvrclient-nextpvr.h   |  4 ++--
 8 files changed, 15 insertions(+), 15 deletions(-)

diff --git a/src/Socket.cpp b/src/Socket.cpp
index 5474e90..eeedf09 100644
--- a/src/Socket.cpp
+++ b/src/Socket.cpp
@@ -18,8 +18,8 @@
  */
 #include "kodi/libXBMC_addon.h"
 #include <string>
-#include "platform/os.h"
-#include "platform/util/timeutils.h"
+#include "p8-platform/os.h"
+#include "p8-platform/util/timeutils.h"
 #include "client.h"
 #include "Socket.h"
 
diff --git a/src/client.h b/src/client.h
index 3b66860..f186d1c 100644
--- a/src/client.h
+++ b/src/client.h
@@ -23,7 +23,7 @@
 #ifndef CLIENT_H
 #define CLIENT_H
 
-#include "platform/util/StdString.h"
+#include "p8-platform/util/StdString.h"
 #include "kodi/libXBMC_addon.h"
 #include "kodi/libXBMC_pvr.h"
 #include "kodi/libKODI_guilib.h"
diff --git a/src/liveshift.cpp b/src/liveshift.cpp
index 2c36c39..12466e7 100644
--- a/src/liveshift.cpp
+++ b/src/liveshift.cpp
@@ -19,7 +19,7 @@
  *
  */
 #include "liveshift.h"
-#include "platform/util/timeutils.h"
+#include "p8-platform/util/timeutils.h"
 
 const int MAX_WINDOW_SIZE = 6;
 const int STARTUP_CACHE_SIZE = 5000000;
diff --git a/src/liveshift.h b/src/liveshift.h
index d983800..0c4be74 100644
--- a/src/liveshift.h
+++ b/src/liveshift.h
@@ -25,7 +25,7 @@
 
 #include "kodi/libXBMC_addon.h"
 #include <string>
-#include "platform/os.h"
+#include "p8-platform/os.h"
 #include "Socket.h"
 
 class LiveShiftSource
diff --git a/src/md5.h b/src/md5.h
index e0abaab..f879e6f 100644
--- a/src/md5.h
+++ b/src/md5.h
@@ -22,7 +22,7 @@
 #ifndef _MD5_H_
 #define _MD5_H_ 1
 
-#include "platform/util/StdString.h"
+#include "p8-platform/util/StdString.h"
 
 
 struct MD5Context {
diff --git a/src/os-dependent.h b/src/os-dependent.h
index 607ec29..abd3d4a 100644
--- a/src/os-dependent.h
+++ b/src/os-dependent.h
@@ -23,7 +23,7 @@
 #define NOMINMAX                      // don't define min() and max() to prevent a clash with std::min() and std::max
 #endif
 
-#include "platform/os.h"
+#include "p8-platform/os.h"
 
 #if defined(TARGET_WINDOWS)
 #  include "windows/os_windows.h"
diff --git a/src/pvrclient-nextpvr.cpp b/src/pvrclient-nextpvr.cpp
index 566a9e8..de91e57 100644
--- a/src/pvrclient-nextpvr.cpp
+++ b/src/pvrclient-nextpvr.cpp
@@ -22,8 +22,8 @@
 #include <stdlib.h>
 #include <memory>
 
-#include "platform/os.h"
-#include "platform/util/timeutils.h"
+#include "p8-platform/os.h"
+#include "p8-platform/util/timeutils.h"
 
 #include "client.h"
 #include "pvrclient-nextpvr.h"
@@ -1907,7 +1907,7 @@ void cPVRClientNextPVR::CloseLiveStream(void)
 
 long long cPVRClientNextPVR::SeekLiveStream(long long iPosition, int iWhence)
 {
-  PLATFORM::CLockObject lock(m_mutex);
+  P8PLATFORM::CLockObject lock(m_mutex);
 
   if (m_pLiveShiftSource != NULL)
   {
@@ -2105,7 +2105,7 @@ void cPVRClientNextPVR::CloseRecordedStream(void)
 
 int cPVRClientNextPVR::ReadRecordedStream(unsigned char *pBuffer, unsigned int iBufferSize)
 {
-  PLATFORM::CLockObject lock(m_mutex);
+  P8PLATFORM::CLockObject lock(m_mutex);
   XBMC->Log(LOG_DEBUG, "ReadRecordedStream(%d bytes from offset %d)", iBufferSize, (int)m_currentRecordingPosition);
 
   // do we have enough data to fill this buffer? 
@@ -2130,7 +2130,7 @@ int cPVRClientNextPVR::ReadRecordedStream(unsigned char *pBuffer, unsigned int i
 
 long long cPVRClientNextPVR::SeekRecordedStream(long long iPosition, int iWhence)
 {
-  PLATFORM::CLockObject lock(m_mutex);
+  P8PLATFORM::CLockObject lock(m_mutex);
 
   if (m_currentRecordingLength != 0)
   {
@@ -2199,7 +2199,7 @@ const char* cPVRClientNextPVR::GetLiveStreamURL(const PVR_CHANNEL &channelinfo)
 /** http handling */
 int cPVRClientNextPVR::DoRequest(const char *resource, CStdString &response)
 {
-  PLATFORM::CLockObject lock(m_mutex);
+  P8PLATFORM::CLockObject lock(m_mutex);
 
   // build request string, adding SID if requred
   CStdString strURL;
diff --git a/src/pvrclient-nextpvr.h b/src/pvrclient-nextpvr.h
index eeacf40..90f6c23 100644
--- a/src/pvrclient-nextpvr.h
+++ b/src/pvrclient-nextpvr.h
@@ -25,7 +25,7 @@
 
 /* Local includes */
 #include "Socket.h"
-#include "platform/threads/mutex.h"
+#include "p8-platform/threads/mutex.h"
 #include "RingBuffer.h"
 #include "liveshift.h"
 
@@ -155,7 +155,7 @@ class cPVRClientNextPVR
   int                     m_iCurrentChannel;
   bool                    m_bConnected;  
   std::string             m_BackendName;
-  PLATFORM::CMutex        m_mutex;
+  P8PLATFORM::CMutex        m_mutex;
 
   CRingBuffer             m_incomingStreamBuffer;
 

From 932679b346be3c4ad9698ca0496c57e72f99d0aa Mon Sep 17 00:00:00 2001
From: "h.udo" <hudokkow@gmail.com>
Date: Wed, 6 Jan 2016 15:21:42 +0000
Subject: [PATCH 2/2] [cmake] Update to p8-platform

---
 CMakeLists.txt | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index a2934b4..27fc7f3 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -8,11 +8,11 @@ enable_language(CXX)
 
 find_package(kodi REQUIRED)
 find_package(kodiplatform REQUIRED)
-find_package(platform REQUIRED)
+find_package(p8-platform REQUIRED)
 find_package(TinyXML REQUIRED)
 
 include_directories(${kodiplatform_INCLUDE_DIRS}
-                    ${platform_INCLUDE_DIRS}
+                    ${p8-platform_INCLUDE_DIRS}
                     ${TINYXML_INCLUDE_DIR}
                     ${KODI_INCLUDE_DIR})
 
@@ -24,7 +24,7 @@ set(NEXTPVR_SOURCES src/client.cpp
                     src/Socket.cpp
                     src/uri.cpp)
 
-SET(DEPLIBS ${platform_LIBRARIES}
+SET(DEPLIBS ${p8-platform_LIBRARIES}
             ${TINYXML_LIBRARIES})
 if(WIN32)
   list(APPEND DEPLIBS ws2_32)
